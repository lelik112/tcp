package net.cheltsov.mtproto

import java.security.spec.{RSAPrivateKeySpec, RSAPublicKeySpec}
import java.security.{KeyFactory, PrivateKey, PublicKey}

object KeyHolder {
  private val modulus = BigInt("AA27C47C777750D6A2E9D0240228E1B065520951E208B05A571BCDA6A40347F2A28A31E0DD4729EF6003" +
    "4A2CACDE798843967D15BE8A358B1D01C7FB028B5E44B3BFCFF78A2F7C6E9C58DA03C67FB4295838612AD8DE80B26A706ED92EDDE00B782" +
    "150BE2ED4DA44FC5DEE5F63D5806E34A1FD4DF99FE9D6E3FAA4A659D2F025BC7D6E92D20356E0AFEA0EB365144E3E06A9628DA8FA499503" +
    "73CCE94937CC2C0C6758E19CB9A9B007F03F529BF47200BA8306FD2DFAAC445E92CAE01EDBEEB247FE4269DC14A5352BF2FD7CCD4A6DB3B" +
    "A338A9072EC935CF3B8B95870AA9812D711C54849876309A53068371002A49A72EE5F773A9A2AC7F70F65820D0F38A9", 16)
  private val privateExponent = BigInt("3209F9DD84A081146DDA86CC601A37ACD14F1BD089C176634AE4B148C548F5BAA41431F0E802" +
    "0A920BD14BD9F18887830C255069B99C197CECADDE6AB1E7DC7425CC4DD3853ECBC01798859CC09E4394390E737CCF4437E2C02C8A5CB24" +
    "CAB9B93DB704C4DA768FD0A9E71007A728A0F5EC9189DFAC00D5B95B5DAFFD4C094C079789DBDCED10C303B930D12A901E3560D9E91EE7D" +
    "ADD1983CF822C46B27E128B83D6691E68BC28AF2F8ACC818937804B3B41533E69F2DDDF3FE2BB11087AD98B15E5E2468377451C4310FCF1" +
    "E24115F44B04C9D75DB704107C00363ABF084882E41E108B29822E135D2AC8CF112D73B83E359000AD0E53F943E31CA59A9D1F5", 16)
  private val publicExponent = BigInt(65537)

  private val rsaKeyFactory: KeyFactory = KeyFactory.getInstance("RSA")
  private val publicKeyConstant: PublicKey =
    rsaKeyFactory.generatePublic(new RSAPublicKeySpec(modulus.bigInteger, publicExponent.bigInteger))
  private val privateKeyConstant: PrivateKey =
    rsaKeyFactory.generatePrivate(new RSAPrivateKeySpec(modulus.bigInteger, privateExponent.bigInteger))

  def publicKey: PublicKey = publicKeyConstant

  def privateKey: PrivateKey = privateKeyConstant
}
